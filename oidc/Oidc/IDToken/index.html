<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>IDToken (oidc.Oidc.IDToken)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">oidc</a> &#x00BB; <a href="../index.html">Oidc</a> &#x00BB; IDToken</nav><h1>Module <code>Oidc.IDToken</code></h1><p>ID Token validation and creation</p><p><a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">Spec link</a></p><nav class="toc"><ul><li><a href="#extra-info">Extra info</a></li></ul></nav></header><dl><dt class="spec type" id="type-validation_error"><a href="#type-validation_error" class="anchor"></a><code><span class="keyword">type</span> validation_error</code> = <code>[ </code><table class="variant"><tr id="type-validation_error.Expired" class="anchored"><td class="def constructor"><a href="#type-validation_error.Expired" class="anchor"></a><code>| </code><code>`Expired</code></td></tr><tr id="type-validation_error.Iat_in_future" class="anchored"><td class="def constructor"><a href="#type-validation_error.Iat_in_future" class="anchor"></a><code>| </code><code>`Iat_in_future</code></td></tr><tr id="type-validation_error.Invalid_nonce" class="anchored"><td class="def constructor"><a href="#type-validation_error.Invalid_nonce" class="anchor"></a><code>| </code><code>`Invalid_nonce</code></td></tr><tr id="type-validation_error.Invalid_signature" class="anchored"><td class="def constructor"><a href="#type-validation_error.Invalid_signature" class="anchor"></a><code>| </code><code>`Invalid_signature</code></td></tr><tr id="type-validation_error.Invalid_sub_length" class="anchored"><td class="def constructor"><a href="#type-validation_error.Invalid_sub_length" class="anchor"></a><code>| </code><code>`Invalid_sub_length</code></td></tr><tr id="type-validation_error.Missing_aud" class="anchored"><td class="def constructor"><a href="#type-validation_error.Missing_aud" class="anchor"></a><code>| </code><code>`Missing_aud</code></td></tr><tr id="type-validation_error.Missing_exp" class="anchored"><td class="def constructor"><a href="#type-validation_error.Missing_exp" class="anchor"></a><code>| </code><code>`Missing_exp</code></td></tr><tr id="type-validation_error.Missing_iat" class="anchored"><td class="def constructor"><a href="#type-validation_error.Missing_iat" class="anchor"></a><code>| </code><code>`Missing_iat</code></td></tr><tr id="type-validation_error.Missing_iss" class="anchored"><td class="def constructor"><a href="#type-validation_error.Missing_iss" class="anchor"></a><code>| </code><code>`Missing_iss</code></td></tr><tr id="type-validation_error.Missing_nonce" class="anchored"><td class="def constructor"><a href="#type-validation_error.Missing_nonce" class="anchor"></a><code>| </code><code>`Missing_nonce</code></td></tr><tr id="type-validation_error.Missing_sub" class="anchored"><td class="def constructor"><a href="#type-validation_error.Missing_sub" class="anchor"></a><code>| </code><code>`Missing_sub</code></td></tr><tr id="type-validation_error.Msg" class="anchored"><td class="def constructor"><a href="#type-validation_error.Msg" class="anchor"></a><code>| </code><code>`Msg <span class="keyword">of</span> string</code></td></tr><tr id="type-validation_error.No_jwk_provided" class="anchored"><td class="def constructor"><a href="#type-validation_error.No_jwk_provided" class="anchor"></a><code>| </code><code>`No_jwk_provided</code></td></tr><tr id="type-validation_error.Unexpected_nonce" class="anchored"><td class="def constructor"><a href="#type-validation_error.Unexpected_nonce" class="anchor"></a><code>| </code><code>`Unexpected_nonce</code></td></tr><tr id="type-validation_error.Unsafe" class="anchored"><td class="def constructor"><a href="#type-validation_error.Unsafe" class="anchor"></a><code>| </code><code>`Unsafe</code></td></tr><tr id="type-validation_error.Wrong_aud_value" class="anchored"><td class="def constructor"><a href="#type-validation_error.Wrong_aud_value" class="anchor"></a><code>| </code><code>`Wrong_aud_value <span class="keyword">of</span> string</code></td></tr><tr id="type-validation_error.Wrong_iss_value" class="anchored"><td class="def constructor"><a href="#type-validation_error.Wrong_iss_value" class="anchor"></a><code>| </code><code>`Wrong_iss_value <span class="keyword">of</span> string</code></td></tr></table><code> ]</code></dt><dd><p>Possible validation errors</p></dd></dl><dl><dt class="spec value" id="val-validate"><a href="#val-validate" class="anchor"></a><code><span class="keyword">val</span> validate : <span>?&#8288;nonce:string</span> <span>&#45;&gt;</span> <span>?&#8288;jwk:<span><span class="type-var">'a</span> Jose.Jwk.t</span></span> <span>&#45;&gt;</span> <span>client:<a href="../Client/index.html#type-t">Client.t</a></span> <span>&#45;&gt;</span> <span>issuer:string</span> <span>&#45;&gt;</span> Jose.Jwt.t <span>&#45;&gt;</span> <span><span>(Jose.Jwt.t, <a href="index.html#type-validation_error">validation_error</a>)</span> Stdlib.result</span></code></dt><dd><p>Validation of the ID Token according to the spec.</p><p><code>jwk</code> is not needed when <code>&quot;alg&quot;: &quot;none&quot;</code></p><p><a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">Spec link</a></p></dd></dl><section><header><h3 id="extra-info"><a href="#extra-info" class="anchor"></a>Extra info</h3><p>Required fields</p><ul><li>iss</li><li>sub - not longer than 256 ASCII chars</li><li>aud</li><li>exp</li><li>iat</li></ul><p>Fields to be validated if exists</p><ul><li>nonce</li></ul><p>Optional fields:</p><ul><li>acr</li><li>amr</li><li>azp (required if aud is a list)</li></ul></header></section></div></body></html>